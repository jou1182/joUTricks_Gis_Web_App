<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="ุชุทุจูู ูุธู ุงููุนูููุงุช ุงูุฌุบุฑุงููุฉ ุงูุชุนูููู - JoUTricks" />
    <meta name="author" content="Dr. Youssef Seleim - JoUTricks" />
    <title>ุชุทุจูู ูุธู ุงููุนูููุงุช ุงูุฌุบุฑุงููุฉ - JoUTricks v3.5</title>

    <!-- Favicon -->
    <link rel="icon" type="image/png" href="logo.png" />

    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    
    <!-- Custom Styles -->
    <link rel="stylesheet" href="style.css" />

    <!-- External Libraries -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/shpjs@latest/dist/shp.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/togeojson/0.16.0/togeojson.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    <script src="https://unpkg.com/topojson-client@3"></script>
    <script src="https://unpkg.com/shp-write@latest/shpwrite.js"></script>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="header-left">
                <img src="logo.png" alt="JoUTricks Logo" class="logo-img" onerror="this.style.display='none'" />
                <div class="header-title">
                    <h1>ุชุทุจูู ูุธู ุงููุนูููุงุช ุงูุฌุบุฑุงููุฉ</h1>
                    <p class="header-subtitle">JoUTricks GIS Viewer v3.5</p>
                </div>
            </div>
            <div class="header-actions">
                <button id="saveSessionBtn" class="btn-header" title="ุญูุธ ุงูุฌูุณุฉ ุงูุญุงููุฉ">
                    <span class="icon">๐พ</span> ุญูุธ ุงูุฌูุณุฉ
                </button>
                <button id="loadSessionBtn" class="btn-header" title="ุงุณุชุนุงุฏุฉ ุฌูุณุฉ ูุญููุธุฉ">
                    <span class="icon">๐</span> ุงุณุชุนุงุฏุฉ ุงูุฌูุณุฉ
                </button>
                <button id="logoutBtn" class="btn-logout" title="ุชุณุฌูู ุงูุฎุฑูุฌ" style="display:none;">
                    <span class="icon">๐ช</span> ุชุณุฌูู ุงูุฎุฑูุฌ
                </button>
            </div>
        </div>
    </header>

    <!-- Login Modal -->
    <div id="loginModal" class="modal">
        <div class="modal-content login-modal">
            <div class="modal-header">
                <img src="logo.png" class="login-logo" alt="JoUTricks Logo" onerror="this.style.display='none'" />
                <h2>๐ ุชุณุฌูู ุงูุฏุฎูู</h2>
                <p class="modal-subtitle">ูุฑุญุจุงู ุจู ูู ุชุทุจูู ูุธู ุงููุนูููุงุช ุงูุฌุบุฑุงููุฉ</p>
            </div>
            <div class="modal-body">
                <form id="loginForm">
                    <div class="form-group">
                        <label for="username">
                            <span class="icon">๐ค</span> ุงุณู ุงููุณุชุฎุฏู:
                        </label>
                        <input type="text" id="username" placeholder="ุฃุฏุฎู ุงุณู ุงููุณุชุฎุฏู" required autofocus />
                    </div>
                    <div class="form-group">
                        <label for="password">
                            <span class="icon">๐</span> ูููุฉ ุงููุฑูุฑ:
                        </label>
                        <input type="password" id="password" placeholder="ุฃุฏุฎู ูููุฉ ุงููุฑูุฑ" required />
                    </div>
                    <div id="loginError" class="error-message"></div>
                    <button type="submit" class="btn-login">
                        <span class="icon">๐</span> ุฏุฎูู
                    </button>
                </form>
                <div class="hint-box">
                    <p class="hint-text">๐ก <strong>ุจูุงูุงุช ุชุฌุฑูุจูุฉ:</strong></p>
                    <code>Username: jou | Password: tricks</code>
                </div>
            </div>
        </div>
    </div>

    <!-- Main App -->
    <div id="appContainer" class="hidden">
        <div class="main-container">
            <!-- Sidebar -->
            <aside class="sidebar">
                <div class="sidebar-content">
                    <!-- Upload Section -->
                    <div class="section">
                        <h3 class="section-title">
                            <span class="icon">๐</span> ุฑูุน ุงูุจูุงูุงุช ุงูุฌุบุฑุงููุฉ
                        </h3>
                        <div id="uploadArea" class="upload-area">
                            <div class="upload-icon">๐</div>
                            <p class="upload-text">ุงุณุญุจ ุงููููุงุช ููุง ุฃู ุงุถุบุท ููุงุฎุชูุงุฑ</p>
                            <p class="upload-formats">
                                <strong>ุงูุตูุบ ุงููุฏุนููุฉ:</strong><br/>
                                GeoJSON, Shapefile (ZIP), KML, KMZ, GPX, CSV, TopoJSON, WKT
                            </p>
                            <input id="fileInput" type="file" accept=".geojson,.json,.zip,.kml,.kmz,.gpx,.csv,.topojson,.wkt" style="display:none;" multiple />
                        </div>
                        <div id="uploadStatus" class="status-message"></div>
                    </div>

                    <!-- Layers Section -->
                    <div class="section">
                        <h3 class="section-title">
                            <span class="icon">๐๏ธ</span> ุฅุฏุงุฑุฉ ุงูุทุจูุงุช
                            <span class="layer-count" id="layerCount">(0)</span>
                        </h3>
                        <div id="layersList" class="layers-list">
                            <p class="empty-message">ูุง ุชูุฌุฏ ุทุจูุงุช ูุถุงูุฉ ุจุนุฏ</p>
                        </div>
                    </div>

                    <!-- Attribute Search Section -->
                    <div class="section">
                        <h3 class="section-title">
                            <span class="icon">๐</span> ุงูุจุญุซ ูู ุงูุณูุงุช
                        </h3>
                        <div class="form-group">
                            <label for="searchField">ุงุณู ุงูุญูู:</label>
                            <input id="searchField" type="text" placeholder="ูุซุงู: name, id, type" />
                        </div>
                        <div class="form-group">
                            <label for="searchValue">ูููุฉ ุงูุจุญุซ:</label>
                            <input id="searchValue" type="text" placeholder="ูุซุงู: Cairo" />
                        </div>
                        <button id="searchBtn" class="btn-control btn-primary">
                            <span class="icon">๐</span> ุจุญุซ
                        </button>
                        <div id="searchStatus" class="status-message"></div>
                    </div>

                    <!-- Map Controls Section -->
                    <div class="section">
                        <h3 class="section-title">
                            <span class="icon">๐๏ธ</span> ุฃุฏูุงุช ุงูุชุญูู
                        </h3>
                        <div class="control-buttons">
                            <button id="zoomInBtn" class="btn-control" title="ุชูุจูุฑ">
                                <span class="icon">๐+</span> ุชูุจูุฑ
                            </button>
                            <button id="zoomOutBtn" class="btn-control" title="ุชุตุบูุฑ">
                                <span class="icon">๐-</span> ุชุตุบูุฑ
                            </button>
                            <button id="resetMapBtn" class="btn-control" title="ุฅุนุงุฏุฉ ุชุนููู">
                                <span class="icon">๐</span> ุฅุนุงุฏุฉ ุชุนููู
                            </button>
                            <button id="clearLayersBtn" class="btn-control btn-danger" title="ุญุฐู ุฌููุน ุงูุทุจูุงุช">
                                <span class="icon">๐๏ธ</span> ุญุฐู ุงููู
                            </button>
                        </div>
                    </div>

                    <!-- Feature Info Section -->
                    <div class="section">
                        <h3 class="section-title">
                            <span class="icon">โน๏ธ</span> ูุนูููุงุช ุงูุนูุตุฑ
                        </h3>
                        <div id="featureInfo" class="feature-info">
                            <p class="empty-message">ุงููุฑ ุนูู ุนูุตุฑ ูู ุงูุฎุฑูุทุฉ ูุนุฑุถ ูุนูููุงุชู</p>
                        </div>
                    </div>
                </div>
            </aside>

            <!-- Map Container -->
            <main class="map-container">
                <div id="map" class="map"></div>
                <div class="map-loading" id="mapLoading" style="display:none;">
                    <div class="spinner"></div>
                    <p>ุฌุงุฑู ุชุญููู ุงูุฎุฑูุทุฉ...</p>
                </div>
            </main>
        </div>
    </div>

    <!-- Layer Picker Modal -->
    <div id="layerPickerModal" class="modal hidden">
        <div class="modal-content medium">
            <div class="modal-header">
                <h2><span class="icon">๐</span> ุงุฎุชูุงุฑ ุงูุทุจูุฉ</h2>
            </div>
            <div class="modal-body">
                <p id="layerFileName" class="info-text"></p>
                <div class="table-container">
                    <table class="layer-table">
                        <thead>
                            <tr>
                                <th>ุงุณู ุงูุทุจูุฉ</th>
                                <th>ููุน ุงูููุฏุณุฉ</th>
                                <th>ุนุฏุฏ ุงููุนุงูู</th>
                                <th>ุงูุฅุฌุฑุงุก</th>
                            </tr>
                        </thead>
                        <tbody id="layerPickerTable"></tbody>
                    </table>
                </div>
                <div class="modal-actions">
                    <button id="cancelLayerPicker" class="btn-secondary">
                        <span class="icon">โ๏ธ</span> ุฅุบูุงู
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Style Editor Modal -->
    <div id="styleEditorModal" class="modal hidden">
        <div class="modal-content medium">
            <div class="modal-header">
                <h2><span class="icon">๐จ</span> ุชุนุฏูู ููุท ุงูุทุจูุฉ</h2>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="styleColor">
                        <span class="icon">๐จ</span> ุงูููู:
                    </label>
                    <div class="color-input-group">
                        <input type="color" id="styleColor" value="#ff6b6b" />
                        <input type="text" id="styleColorText" value="#ff6b6b" placeholder="#FF6B6B" />
                    </div>
                </div>
                <div class="form-group">
                    <label for="styleWeight">
                        <span class="icon">๐</span> ุณูุงูุฉ ุงูุฎุท: <span id="weightValue">2</span>
                    </label>
                    <input type="range" id="styleWeight" min="1" max="10" value="2" step="1" />
                </div>
                <div class="form-group">
                    <label for="styleOpacity">
                        <span class="icon">๐ง</span> ุงูุดูุงููุฉ: <span id="opacityValue">0.4</span>
                    </label>
                    <input type="range" id="styleOpacity" min="0" max="1" value="0.4" step="0.1" />
                </div>
                <div class="form-group">
                    <label for="styleRadius">
                        <span class="icon">โซ</span> ุญุฌู ุงูููุงุท: <span id="radiusValue">6</span>
                    </label>
                    <input type="range" id="styleRadius" min="2" max="20" value="6" step="1" />
                </div>
                <div class="form-group">
                    <label for="styleShape">
                        <span class="icon">๐</span> ุดูู ุงูููุงุท:
                    </label>
                    <select id="styleShape">
                        <option value="circle">ุฏุงุฆุฑุฉ (Circle)</option>
                        <option value="marker">ุนูุงูุฉ (Marker)</option>
                    </select>
                </div>
                <div class="modal-actions">
                    <button id="applyStyleBtn" class="btn-primary">
                        <span class="icon">โ</span> ุชุทุจูู
                    </button>
                    <button id="cancelStyleBtn" class="btn-secondary">
                        <span class="icon">โ๏ธ</span> ุฅูุบุงุก
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Export Modal -->
    <div id="exportModal" class="modal hidden">
        <div class="modal-content small">
            <div class="modal-header">
                <h2><span class="icon">๐ฅ</span> ุชุตุฏูุฑ ุงูุทุจูุฉ</h2>
            </div>
            <div class="modal-body">
                <p>ุงุฎุชุฑ ุตูุบุฉ ุงูุชุตุฏูุฑ:</p>
                <div class="export-options">
                    <button id="exportGeoJSON" class="btn-export">
                        <span class="icon">๐</span> GeoJSON
                    </button>
                    <button id="exportShapefile" class="btn-export">
                        <span class="icon">๐ฆ</span> Shapefile (ZIP)
                    </button>
                </div>
                <div class="modal-actions">
                    <button id="cancelExport" class="btn-secondary">
                        <span class="icon">โ๏ธ</span> ุฅูุบุงุก
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Script -->
    <script src="script.js"></script>
</body>
</html>
